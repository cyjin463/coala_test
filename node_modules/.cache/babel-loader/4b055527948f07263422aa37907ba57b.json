{"ast":null,"code":"import _defineProperty from\"/Users/cyj/sun/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";var _handleActions;import{createAction,handleActions}from\"redux-actions\";import produce from\"immer\";import axios from\"axios\";import{apis}from\"../../shared/api\";import{apiUrl}from\"../../elements/testApiUrl\";var GET_ANSWER=\"GET_ANSWER\";var ADD_ANSWER=\"ADD_ANSWER\";var EDIT_ANSWER=\"EDIT_ANSWER\";var DEL_ANSWER=\"DEL_ANSWER\";var LIKE_ANSWER=\"LIKE_ANSWER\";var AS_IMG_POST=\"AS_IMG_POST\";var getAnswer=createAction(GET_ANSWER,function(list){return{list:list};});var addAnswer=createAction(ADD_ANSWER,function(list){return{list:list};});var editAnswer=createAction(EDIT_ANSWER,function(list){return{list:list};});var likeAnswer=createAction(LIKE_ANSWER,function(list){return{list:list};});var delAnswer=createAction(DEL_ANSWER,function(list){return{list:list};});var asImgPost=createAction(AS_IMG_POST,function(asPreview){return{asPreview:asPreview};});var initialState={list:[],editList:[],asPreview:\"\",status:false};var getAnswerDB=function getAnswerDB(pid){return function(dispatch,getState,_ref){var history=_ref.history;apis.getanswer(pid).then(function(res){dispatch(getAnswer(res.data));}).catch(function(err){console.log(err);});};};var addAnswerDB=function addAnswerDB(_ref2){var pid=_ref2.pid,uid=_ref2.uid,answerTitle=_ref2.answerTitle,answerComment=_ref2.answerComment;return function(dispatch,getState,_ref3){var history=_ref3.history;var token_res=sessionStorage.getItem(\"token\");var img_list=getState().answer.asPreview;var formData=new FormData();formData.append(\"images\",img_list);if(!img_list){axios({method:\"post\",url:\"\".concat(apiUrl,\"/islogin/answer/\").concat(pid),data:{pid:pid,uid:uid,answerTitle:answerTitle,answerComment:answerComment,answerImg:null},headers:{Authorization:token_res}}).then(function(res){dispatch(addAnswer({pid:pid,uid:uid,answerTitle:answerTitle,answerComment:answerComment,answerImg:null,answerId:res.data,answerLike:false,blogUrl:null,career:null,commnetResponseDtoList:[],createdAt:\"\",nickname:\"\",userImage:null}));});}else{axios.post(\"\".concat(apiUrl,\"/images/upload\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\",Authorization:\"\".concat(token_res)}}).then(function(res){console.log(\"img업로드 성공\");var imgUrl=res.data.url;return imgUrl;}).then(function(imgUrl){console.log(\"img업로드 성공\");axios({method:\"post\",url:\"\".concat(apiUrl,\"/islogin/answer/\").concat(pid),data:{pid:pid,uid:uid,answerTitle:answerTitle,answerComment:answerComment,answerImg:imgUrl},headers:{Authorization:token_res}}).then(function(res){dispatch(addAnswer({pid:pid,uid:uid,answerTitle:answerTitle,answerComment:answerComment,answerImg:imgUrl,answerId:res.data,answerLike:false,blogUrl:null,career:null,commnetResponseDtoList:[],createdAt:\"\",nickname:\"\",userImage:null}));});}).catch(function(err){console.log(err);});}};};var editAnswerDB=function editAnswerDB(props){return function(dispatch,getState,_ref4){var history=_ref4.history;var uid=props.uid,pid=props.pid,answerId=props.answerId,answerUid=props.answerUid,userImage=props.userImage,answerComment=props.answerComment,answerImg=props.answerImg,answerTitle=props.answerTitle,blogUrl=props.blogUrl,nickname=props.nickname,createdAt=props.createdAt,career=props.career,commnetResponseDtoList=props.commnetResponseDtoList;var token_res=sessionStorage.getItem(\"token\");var img_list=getState().answer.asPreview;var formData=new FormData();formData.append(\"images\",img_list);if(!img_list){axios({method:\"put\",url:\"\".concat(apiUrl,\"/islogin/answer/revice/\").concat(answerId),data:{answerTitle:answerTitle,answerComment:answerComment,answerImg:answerImg},headers:{Authorization:token_res}}).then(function(res){var list={uid:uid,pid:pid,answerId:answerId,answerUid:answerUid,userImage:userImage,answerComment:answerComment,answerImg:answerImg,answerTitle:answerTitle,blogUrl:blogUrl,nickname:nickname,createdAt:createdAt,career:career,commnetResponseDtoList:commnetResponseDtoList};var _answer_list=getState().answer.list;var answer_list=_answer_list.map(function(v){return v.answerId===answerId?list:v;});dispatch(editAnswer(answer_list));// window.location.replace(`/detail/${pid}`);\n});}else{axios.post(\"\".concat(apiUrl,\"/images/upload\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\",Authorization:\"\".concat(token_res)}}).then(function(res){var imgUrl=res.data.url;return imgUrl;}).then(function(imgUrl){console.log(\"img업로드 성공\");console.log(imgUrl);axios({method:\"put\",url:\"\".concat(apiUrl,\"/islogin/answer/revice/\").concat(answerId),data:{answerTitle:answerTitle,answerComment:answerComment,answerImg:imgUrl},headers:{Authorization:token_res}}).then(function(res){var list={uid:uid,pid:pid,answerId:answerId,answerUid:answerUid,userImage:userImage,answerComment:answerComment,answerImg:imgUrl,answerTitle:answerTitle,blogUrl:blogUrl,nickname:nickname,createdAt:createdAt,career:career,commnetResponseDtoList:commnetResponseDtoList};var _answer_list=getState().answer.list;var answer_list=_answer_list.map(function(v){return v.answerId===answerId?list:v;});dispatch(editAnswer(answer_list));// window.location.replace(`/detail/${pid}`);\n});}).catch(function(err){console.log(err);});}};};var delAnswerDB=function delAnswerDB(answsrId){return function(dispatch,getState,_ref5){var history=_ref5.history;apis.delanswer(answsrId).then(function(){var _answer_list=getState().answer.list;var answer_list=_answer_list.filter(function(v){return v.answerId!==answsrId;});dispatch(delAnswer(answer_list));}).catch(function(err){console.log(err);});};};var chooseAnswerDB=function chooseAnswerDB(props){return function(dispatch,getState){console.log(props);var uid=props.uid,pid=props.pid,answerId=props.answerId,answerUid=props.answerUid,userImage=props.userImage,answerComment=props.answerComment,answerImg=props.answerImg,answerTitle=props.answerTitle,blogUrl=props.blogUrl,nickname=props.nickname,createdAt=props.createdAt,career=props.career,commnetResponseDtoList=props.commnetResponseDtoList,status=props.status;apis.chooseAnswer(uid,pid,answerId,answerUid).then(function(res){var status=res.data.status;var list={uid:uid,pid:pid,answerId:answerId,answerUid:answerUid,userImage:userImage,answerComment:answerComment,answerImg:answerImg,answerTitle:answerTitle,blogUrl:blogUrl,nickname:nickname,createdAt:createdAt,career:career,commnetResponseDtoList:commnetResponseDtoList,status:status};var _answer_list=getState().answer.list;var answer_list=_answer_list.map(function(v){return v.answerId===answerId?list:v;});dispatch(likeAnswer(answer_list));// window.location.replace(`/detail/${pid}`);\n}).catch(function(err){console.log(err);});};};export default handleActions((_handleActions={},_defineProperty(_handleActions,GET_ANSWER,function(state,action){return produce(state,function(draft){draft.list=action.payload.list;});}),_defineProperty(_handleActions,ADD_ANSWER,function(state,action){return produce(state,function(draft){draft.list.unshift(action.payload.list);draft.asPreview=\"\";});}),_defineProperty(_handleActions,EDIT_ANSWER,function(state,action){return produce(state,function(draft){draft.list=action.payload.list;draft.asPreview=\"\";});}),_defineProperty(_handleActions,DEL_ANSWER,function(state,action){return produce(state,function(draft){draft.list=action.payload.list;});}),_defineProperty(_handleActions,LIKE_ANSWER,function(state,action){return produce(state,function(draft){draft.list=action.payload.list;});}),_defineProperty(_handleActions,AS_IMG_POST,function(state,action){return produce(state,function(draft){draft.asPreview=action.payload.asPreview;});}),_handleActions),initialState);var actionCreators={getAnswerDB:getAnswerDB,addAnswerDB:addAnswerDB,editAnswerDB:editAnswerDB,delAnswerDB:delAnswerDB,chooseAnswerDB:chooseAnswerDB,asImgPost:asImgPost};export{actionCreators};","map":{"version":3,"sources":["/Users/cyj/sun/src/redux/modules/answer.js"],"names":["createAction","handleActions","produce","axios","apis","apiUrl","GET_ANSWER","ADD_ANSWER","EDIT_ANSWER","DEL_ANSWER","LIKE_ANSWER","AS_IMG_POST","getAnswer","list","addAnswer","editAnswer","likeAnswer","delAnswer","asImgPost","asPreview","initialState","editList","status","getAnswerDB","pid","dispatch","getState","history","getanswer","then","res","data","catch","err","console","log","addAnswerDB","uid","answerTitle","answerComment","token_res","sessionStorage","getItem","img_list","answer","formData","FormData","append","method","url","answerImg","headers","Authorization","answerId","answerLike","blogUrl","career","commnetResponseDtoList","createdAt","nickname","userImage","post","imgUrl","editAnswerDB","props","answerUid","_answer_list","answer_list","map","v","delAnswerDB","answsrId","delanswer","filter","chooseAnswerDB","chooseAnswer","state","action","draft","payload","unshift","actionCreators"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport produce from \"immer\";\nimport axios from \"axios\";\nimport { apis } from \"../../shared/api\";\nimport { apiUrl } from \"../../elements/testApiUrl\";\n\nconst GET_ANSWER = \"GET_ANSWER\";\nconst ADD_ANSWER = \"ADD_ANSWER\";\nconst EDIT_ANSWER = \"EDIT_ANSWER\";\nconst DEL_ANSWER = \"DEL_ANSWER\";\nconst LIKE_ANSWER = \"LIKE_ANSWER\";\nconst AS_IMG_POST = \"AS_IMG_POST\";\n\nconst getAnswer = createAction(GET_ANSWER, (list) => ({ list }));\nconst addAnswer = createAction(ADD_ANSWER, (list) => ({ list }));\nconst editAnswer = createAction(EDIT_ANSWER, (list) => ({ list }));\nconst likeAnswer = createAction(LIKE_ANSWER, (list) => ({ list }));\nconst delAnswer = createAction(DEL_ANSWER, (list) => ({ list }));\nconst asImgPost = createAction(AS_IMG_POST, (asPreview) => ({ asPreview }));\n\nconst initialState = {\n  list: [],\n  editList: [],\n  asPreview: \"\",\n  status: false,\n};\n\nconst getAnswerDB = (pid) => {\n  return function (dispatch, getState, { history }) {\n    apis\n      .getanswer(pid)\n      .then((res) => {\n        dispatch(getAnswer(res.data));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst addAnswerDB = ({ pid, uid, answerTitle, answerComment }) => {\n  return function (dispatch, getState, { history }) {\n    const token_res = sessionStorage.getItem(\"token\");\n    const img_list = getState().answer.asPreview;\n    const formData = new FormData();\n    formData.append(\"images\", img_list);\n\n    if (!img_list) {\n      axios({\n        method: \"post\",\n        url: `${apiUrl}/islogin/answer/${pid}`,\n        data: {\n          pid: pid,\n          uid: uid,\n          answerTitle: answerTitle,\n          answerComment: answerComment,\n          answerImg: null,\n        },\n        headers: { Authorization: token_res },\n      }).then((res) => {\n        dispatch(\n          addAnswer({\n            pid,\n            uid,\n            answerTitle: answerTitle,\n            answerComment: answerComment,\n            answerImg: null,\n            answerId: res.data,\n            answerLike: false,\n            blogUrl: null,\n            career: null,\n            commnetResponseDtoList: [],\n            createdAt: \"\",\n            nickname: \"\",\n            userImage: null,\n          })\n        );\n      });\n    } else {\n      axios\n        .post(`${apiUrl}/images/upload`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n            Authorization: `${token_res}`,\n          },\n        })\n        .then((res) => {\n          console.log(\"img업로드 성공\");\n          const imgUrl = res.data.url;\n          return imgUrl;\n        })\n        .then((imgUrl) => {\n          console.log(\"img업로드 성공\");\n          axios({\n            method: \"post\",\n            url: `${apiUrl}/islogin/answer/${pid}`,\n            data: {\n              pid: pid,\n              uid: uid,\n              answerTitle: answerTitle,\n              answerComment: answerComment,\n              answerImg: imgUrl,\n            },\n            headers: { Authorization: token_res },\n          }).then((res) => {\n            dispatch(\n              addAnswer({\n                pid,\n                uid,\n                answerTitle: answerTitle,\n                answerComment: answerComment,\n                answerImg: imgUrl,\n                answerId: res.data,\n                answerLike: false,\n                blogUrl: null,\n                career: null,\n                commnetResponseDtoList: [],\n                createdAt: \"\",\n                nickname: \"\",\n                userImage: null,\n              })\n            );\n          });\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  };\n};\n\nconst editAnswerDB = (props) => {\n  return function (dispatch, getState, { history }) {\n    const {\n      uid,\n      pid,\n      answerId,\n      answerUid,\n      userImage,\n      answerComment,\n      answerImg,\n      answerTitle,\n      blogUrl,\n      nickname,\n      createdAt,\n      career,\n      commnetResponseDtoList,\n    } = props;\n\n    const token_res = sessionStorage.getItem(\"token\");\n    const img_list = getState().answer.asPreview;\n    const formData = new FormData();\n    formData.append(\"images\", img_list);\n\n    if (!img_list) {\n      axios({\n        method: \"put\",\n        url: `${apiUrl}/islogin/answer/revice/${answerId}`,\n        data: {\n          answerTitle: answerTitle,\n          answerComment: answerComment,\n          answerImg: answerImg,\n        },\n        headers: { Authorization: token_res },\n      }).then((res) => {\n        const list = {\n          uid,\n          pid,\n          answerId,\n          answerUid,\n          userImage,\n          answerComment,\n          answerImg,\n          answerTitle,\n          blogUrl,\n          nickname,\n          createdAt,\n          career,\n          commnetResponseDtoList,\n        };\n        const _answer_list = getState().answer.list;\n        const answer_list = _answer_list.map((v) =>\n          v.answerId === answerId ? list : v\n        );\n\n        dispatch(editAnswer(answer_list));\n        // window.location.replace(`/detail/${pid}`);\n      });\n    } else {\n      axios\n        .post(`${apiUrl}/images/upload`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n            Authorization: `${token_res}`,\n          },\n        })\n        .then((res) => {\n          const imgUrl = res.data.url;\n          return imgUrl;\n        })\n        .then((imgUrl) => {\n          console.log(\"img업로드 성공\");\n          console.log(imgUrl);\n          axios({\n            method: \"put\",\n            url: `${apiUrl}/islogin/answer/revice/${answerId}`,\n            data: {\n              answerTitle: answerTitle,\n              answerComment: answerComment,\n              answerImg: imgUrl,\n            },\n            headers: { Authorization: token_res },\n          }).then((res) => {\n            const list = {\n              uid,\n              pid,\n              answerId,\n              answerUid,\n              userImage,\n              answerComment,\n              answerImg: imgUrl,\n              answerTitle,\n              blogUrl,\n              nickname,\n              createdAt,\n              career,\n              commnetResponseDtoList,\n            };\n            const _answer_list = getState().answer.list;\n            const answer_list = _answer_list.map((v) =>\n              v.answerId === answerId ? list : v\n            );\n\n            dispatch(editAnswer(answer_list));\n            // window.location.replace(`/detail/${pid}`);\n          });\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  };\n};\n\nconst delAnswerDB = (answsrId) => {\n  return function (dispatch, getState, { history }) {\n    apis\n      .delanswer(answsrId)\n      .then(() => {\n        const _answer_list = getState().answer.list;\n        const answer_list = _answer_list.filter((v) => v.answerId !== answsrId);\n        dispatch(delAnswer(answer_list));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst chooseAnswerDB = (props) => {\n  return function (dispatch, getState) {\n    console.log(props);\n\n    const {\n      uid,\n      pid,\n      answerId,\n      answerUid,\n      userImage,\n      answerComment,\n      answerImg,\n      answerTitle,\n      blogUrl,\n      nickname,\n      createdAt,\n      career,\n      commnetResponseDtoList,\n      status,\n    } = props;\n\n    apis\n      .chooseAnswer(uid, pid, answerId, answerUid)\n      .then((res) => {\n        const status = res.data.status;\n        const list = {\n          uid,\n          pid,\n          answerId,\n          answerUid,\n          userImage,\n          answerComment,\n          answerImg,\n          answerTitle,\n          blogUrl,\n          nickname,\n          createdAt,\n          career,\n          commnetResponseDtoList,\n          status: status,\n        };\n\n        const _answer_list = getState().answer.list;\n        const answer_list = _answer_list.map((v) =>\n          v.answerId === answerId ? list : v\n        );\n\n        dispatch(likeAnswer(answer_list));\n        // window.location.replace(`/detail/${pid}`);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nexport default handleActions(\n  {\n    [GET_ANSWER]: (state, action) =>\n      produce(state, (draft) => {\n        draft.list = action.payload.list;\n      }),\n    [ADD_ANSWER]: (state, action) =>\n      produce(state, (draft) => {\n        draft.list.unshift(action.payload.list);\n        draft.asPreview = \"\";\n      }),\n    [EDIT_ANSWER]: (state, action) =>\n      produce(state, (draft) => {\n        draft.list = action.payload.list;\n        draft.asPreview = \"\";\n      }),\n    [DEL_ANSWER]: (state, action) =>\n      produce(state, (draft) => {\n        draft.list = action.payload.list;\n      }),\n    [LIKE_ANSWER]: (state, action) =>\n      produce(state, (draft) => {\n        draft.list = action.payload.list;\n      }),\n    [AS_IMG_POST]: (state, action) =>\n      produce(state, (draft) => {\n        draft.asPreview = action.payload.asPreview;\n      }),\n  },\n  initialState\n);\n\nconst actionCreators = {\n  getAnswerDB,\n  addAnswerDB,\n  editAnswerDB,\n  delAnswerDB,\n  chooseAnswerDB,\n  asImgPost,\n};\n\nexport { actionCreators };\n"]},"metadata":{},"sourceType":"module"}