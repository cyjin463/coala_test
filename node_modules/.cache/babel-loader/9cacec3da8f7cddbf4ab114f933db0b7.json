{"ast":null,"code":"import { createAction, handleActions } from \"redux-actions\";\nimport axios from \"axios\";\nimport { setToken } from \"../../shared/token\";\nimport produce from \"immer\";\nimport { apiUrl } from \"../../elements/testApiUrl\";\nimport { apis } from \"../../shared/api\";\nconst SERCH = \"SERCH\";\nconst CATEGORY = \"CATEGORY\";\nconst TAG = \"TAG\";\nconst serch = createAction(SERCH, list => ({\n  list\n}));\nconst categorySerch = createAction(CATEGORY, list => ({\n  list\n}));\nconst tagSearch = createAction(TAG, list => ({\n  list\n}));\nconst token = sessionStorage.getItem(\"token\");\nconst initialState = {\n  serch_list: [],\n  category_list: [],\n  tag_list: []\n};\n\nconst serchDB = (title, page) => {\n  return async function (dispatch, getState, _ref) {\n    let {\n      history\n    } = _ref;\n    console.log(title);\n    await axios.get(`${apiUrl}/post/search/${title}?page=${page}&size=10&sortBy=createdAt&isAsc=false`, {\n      headers: {\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(res);\n      dispatch(serch(res.data));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\n\nconst categoryDB = (category, page) => {\n  return function (dispatch, getState, _ref2) {\n    let {\n      history\n    } = _ref2;\n    axios.get(`${apiUrl}/category/search/${category}?page=${page}&size=10&sortBy=createdAt&isAsc=false`, {\n      headers: {\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(res.data);\n      dispatch(categorySerch(res.data));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\n\nconst tagDB = (tag, page) => {\n  return function (dispatch, getState, _ref3) {\n    let {\n      history\n    } = _ref3;\n    axios.get(`${apiUrl}/tag/search/${tag}?page=${page}&size=10&sortBy=createdAt&isAsc=false`, {\n      headers: {\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(res.data);\n      dispatch(tagSearch(res.data));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\n\nexport default handleActions({\n  [SERCH]: (state, action) => produce(state, draft => {\n    draft.serch_list = action.payload.list; // draft.serch_list.push(...action.payload.list);\n    // draft.serch_list = draft.serch_list.reduce((acc, cur) => {\n    //   if (acc.findIndex((a) => a.pid === cur.pid) === -1) {\n    //     return [...acc, cur];\n    //   } else {\n    //     acc[acc.findIndex((a) => a.pid === cur.pid)] = cur;\n    //     return acc;\n    //   }\n    // }, []);\n  }),\n  [CATEGORY]: (state, action) => produce(state, draft => {\n    draft.category_list.push(...action.payload.list);\n    draft.category_list = draft.category_list.reduce((acc, cur) => {\n      if (acc.findIndex(a => a.pid === cur.pid) === -1) {\n        return [...acc, cur];\n      } else {\n        acc[acc.findIndex(a => a.pid === cur.pid)] = cur;\n        return acc;\n      }\n    }, []);\n  }),\n  [TAG]: (state, action) => produce(state, draft => {\n    draft.tag_list.push(...action.payload.list);\n    draft.tag_list = draft.tag_list.reduce((acc, cur) => {\n      if (acc.findIndex(a => a.pid === cur.pid) === -1) {\n        return [...acc, cur];\n      } else {\n        acc[acc.findIndex(a => a.pid === cur.pid)] = cur;\n        return acc;\n      }\n    }, []);\n  })\n}, initialState);\nconst actionsCreators = {\n  serchDB,\n  serch,\n  categoryDB,\n  categorySerch,\n  tagDB\n};\nexport { actionsCreators };","map":{"version":3,"sources":["/Users/cyj/sun/src/redux/modules/serch.js"],"names":["createAction","handleActions","axios","setToken","produce","apiUrl","apis","SERCH","CATEGORY","TAG","serch","list","categorySerch","tagSearch","token","sessionStorage","getItem","initialState","serch_list","category_list","tag_list","serchDB","title","page","dispatch","getState","history","console","log","get","headers","Authorization","then","res","data","catch","err","categoryDB","category","tagDB","tag","state","action","draft","payload","push","reduce","acc","cur","findIndex","a","pid","actionsCreators"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport axios from \"axios\";\nimport { setToken } from \"../../shared/token\";\nimport produce from \"immer\";\nimport { apiUrl } from \"../../elements/testApiUrl\";\nimport { apis } from \"../../shared/api\";\n\nconst SERCH = \"SERCH\";\nconst CATEGORY = \"CATEGORY\";\nconst TAG = \"TAG\";\n\nconst serch = createAction(SERCH, (list) => ({ list }));\nconst categorySerch = createAction(CATEGORY, (list) => ({ list }));\nconst tagSearch = createAction(TAG, (list) => ({ list }));\n\nconst token = sessionStorage.getItem(\"token\");\n\nconst initialState = {\n  serch_list: [],\n  category_list: [],\n  tag_list: [],\n};\n\nconst serchDB = (title, page) => {\n  return async function (dispatch, getState, { history }) {\n    console.log(title);\n    await axios\n      .get(\n        `${apiUrl}/post/search/${title}?page=${page}&size=10&sortBy=createdAt&isAsc=false`,\n        {\n          headers: {\n            Authorization: token,\n          },\n        }\n      )\n      .then((res) => {\n        console.log(res);\n        dispatch(serch(res.data));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst categoryDB = (category, page) => {\n  return function (dispatch, getState, { history }) {\n    axios\n      .get(\n        `${apiUrl}/category/search/${category}?page=${page}&size=10&sortBy=createdAt&isAsc=false`,\n        {\n          headers: {\n            Authorization: token,\n          },\n        }\n      )\n      .then((res) => {\n        console.log(res.data);\n\n        dispatch(categorySerch(res.data));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nconst tagDB = (tag, page) => {\n  return function (dispatch, getState, { history }) {\n    axios\n      .get(\n        `${apiUrl}/tag/search/${tag}?page=${page}&size=10&sortBy=createdAt&isAsc=false`,\n        {\n          headers: {\n            Authorization: token,\n          },\n        }\n      )\n      .then((res) => {\n        console.log(res.data);\n        dispatch(tagSearch(res.data));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n};\n\nexport default handleActions(\n  {\n    [SERCH]: (state, action) =>\n      produce(state, (draft) => {\n        draft.serch_list = action.payload.list;\n        // draft.serch_list.push(...action.payload.list);\n        // draft.serch_list = draft.serch_list.reduce((acc, cur) => {\n        //   if (acc.findIndex((a) => a.pid === cur.pid) === -1) {\n        //     return [...acc, cur];\n        //   } else {\n        //     acc[acc.findIndex((a) => a.pid === cur.pid)] = cur;\n        //     return acc;\n        //   }\n        // }, []);\n      }),\n    [CATEGORY]: (state, action) =>\n      produce(state, (draft) => {\n        draft.category_list.push(...action.payload.list);\n        draft.category_list = draft.category_list.reduce((acc, cur) => {\n          if (acc.findIndex((a) => a.pid === cur.pid) === -1) {\n            return [...acc, cur];\n          } else {\n            acc[acc.findIndex((a) => a.pid === cur.pid)] = cur;\n            return acc;\n          }\n        }, []);\n      }),\n    [TAG]: (state, action) =>\n      produce(state, (draft) => {\n        draft.tag_list.push(...action.payload.list);\n        draft.tag_list = draft.tag_list.reduce((acc, cur) => {\n          if (acc.findIndex((a) => a.pid === cur.pid) === -1) {\n            return [...acc, cur];\n          } else {\n            acc[acc.findIndex((a) => a.pid === cur.pid)] = cur;\n            return acc;\n          }\n        }, []);\n      }),\n  },\n  initialState\n);\n\nconst actionsCreators = {\n  serchDB,\n  serch,\n  categoryDB,\n  categorySerch,\n  tagDB,\n};\n\nexport { actionsCreators };\n"]},"metadata":{},"sourceType":"module"}