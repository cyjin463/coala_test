{"ast":null,"code":"import { createAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\nimport history from \"../configureStore\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nimport { setToken, delToken } from \"../../shared/token\";\nimport { apiUrl } from \"../../elements/testApiUrl\"; //initialState\n\nconst initialState = {\n  userinfo: {\n    uid: \"\",\n    username: \"\",\n    nickname: \"\",\n    career: \"\",\n    userImage: \"\"\n  },\n  isLogin: false,\n  isCheckUsername: false,\n  isCheckNickname: false,\n  preview: \"\"\n}; //action\n\nconst CHECK_USERNAME = \"CHECK_USERNAME\";\nconst CHECK_NICKNAME = \"CHECK_NICKNAME\";\nconst LOG_IN = \"LOG_IN\";\nconst LOG_OUT = \"LOG_OUT\";\nconst USER_EDUT = \"USER_EDUT\";\nconst IMG_POST = \"IMG_POST\"; //action creators\n\nconst setCheckUsername = createAction(CHECK_USERNAME, isCheckUsername => ({\n  isCheckUsername\n}));\nconst setCheckNickname = createAction(CHECK_NICKNAME, isCheckNickname => ({\n  isCheckNickname\n}));\nconst logIn = createAction(LOG_IN, user => ({\n  user\n}));\nconst logOut = createAction(LOG_OUT, () => ({}));\nconst logEdit = createAction(USER_EDUT, user => ({\n  user\n}));\nconst imgPost = createAction(IMG_POST, preview => ({\n  preview\n})); // //token\n\nconst token = sessionStorage.getItem(\"token\"); //middleware actions\n\nconst checkUsernameDB = (username, isCheckUsername) => {\n  return async function (dispatch, getState, _ref) {\n    let {\n      history\n    } = _ref;\n    console.log(username, isCheckUsername);\n    await axios.post(`${apiUrl}/user/signup/username`, {\n      username: username\n    }).then(res => {\n      if (res.data === true) {\n        Swal.fire(\"\", \"이미 존재하는 ID입니다.\", \"error\");\n        return;\n      }\n\n      dispatch(setCheckUsername(!isCheckUsername));\n      console.log(\"리듀서로\");\n    });\n  };\n};\n\nconst checkNicknameDB = (userNickname, isCheckNickname) => {\n  return async function (dispatch, getState, _ref2) {\n    let {\n      history\n    } = _ref2;\n    console.log(userNickname, isCheckNickname);\n    await axios.post(`${apiUrl}/user/signup/nickname`, {\n      nickname: userNickname\n    }).then(res => {\n      if (res.data === true) {\n        Swal.fire(\"\", \"이미 존재하는 닉네임입ㄴ디ㅏ.\", \"error\");\n        return;\n      }\n\n      console.log(res);\n      dispatch(setCheckNickname(!isCheckNickname));\n    });\n  };\n};\n\nconst signupDB = (username, nickname, password, passwordCheck, career) => {\n  return function (dispatch, getState, _ref3) {\n    let {\n      history\n    } = _ref3;\n    console.log(username, nickname, password, passwordCheck, career);\n    axios.post(`${apiUrl}/user/signup`, {\n      username: username,\n      nickname: nickname,\n      password: password,\n      passwordCheck: passwordCheck,\n      career: career\n    }).then(res => {\n      window.alert(\"회원가입을 축하드립니다.\");\n      window.location.reload();\n    }).catch(err => {\n      console.log(\"회원가입 실패\", err);\n      Swal.fire(\"\", \"회원가입에 실패했어요.\", \"error\");\n    });\n  };\n};\n\nconst loginDB = (username, password) => {\n  return function (dispatch, getState, _ref4) {\n    let {\n      history\n    } = _ref4;\n    console.log(username, password);\n    axios.post(`${apiUrl}/user/login`, {\n      username: username,\n      password: password\n    }).then(res => {\n      console.log(res);\n      const token_res = res.headers.authorization;\n      setToken(token_res);\n      return token_res;\n    }).then(token_res => {\n      console.log(token_res);\n      axios({\n        method: \"post\",\n        url: `${apiUrl}/islogin/user`,\n        headers: {\n          Authorization: `${token_res}`\n        }\n      }).then(res => {\n        console.log(res);\n        sessionStorage.setItem(\"uid\", res.data.uid);\n        sessionStorage.setItem(\"username\", res.data.username);\n        sessionStorage.setItem(\"nickname\", res.data.nickname);\n        sessionStorage.setItem(\"career\", res.data.career);\n        sessionStorage.setItem(\"userImage\", res.data.userImage);\n        sessionStorage.setItem(\"url\", res.data.blogUrl);\n        sessionStorage.setItem(\"isLogin\", true);\n        console.log(\"1번\");\n        dispatch(logIn({\n          uid: res.data.uid,\n          username: res.data.username,\n          nickname: res.data.nickname,\n          career: res.data.career,\n          userImage: res.data.userImage,\n          url: res.data.blogUrl\n        }));\n        history.push(\"/\");\n        window.location.reload();\n      }).catch(err => {\n        console.log(\"로그인 확인 실패\", err);\n      });\n    }).catch(err => {\n      console.log(err);\n      Swal.fire(\"\", \"이메일이나 패스워드를 다시 확인해주세요.\", \"error\");\n    });\n  };\n};\n\nconst logEditDB = (uid, nickname, career, url, userImg) => {\n  return function (dispatch, getState, _ref5) {\n    let {\n      history\n    } = _ref5;\n    console.log(uid, nickname, career, url);\n    axios.put(`${apiUrl}/islogin/user/getinfo/${uid}`, {\n      nickname: nickname,\n      career: career,\n      userImage: \"\",\n      blogUrl: url\n    }, {\n      headers: {\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(res.data);\n      dispatch(logEdit({\n        nickname: nickname,\n        career: career,\n        userImage: userImg,\n        blogUrl: url\n      }));\n      sessionStorage.setItem(\"nickname\", nickname);\n      sessionStorage.setItem(\"career\", career);\n      sessionStorage.setItem(\"url\", url);\n      window.location.replace(\"/\");\n    }).catch(err => {\n      console.log(err);\n      Swal.fire(\"\", \"회원 정보 수정 실패\", \"error\");\n    });\n  };\n};\n\nconst logEditDB2 = (uid, nickname, career, url, userImg) => {\n  return function (dispatch, getState, _ref6) {\n    let {\n      history\n    } = _ref6;\n    const img_list = getState().user.preview;\n    const Data = new FormData();\n    Data.append(\"images\", img_list);\n    console.log(img_list);\n    axios.post(`${apiUrl}/images/upload`, Data, {\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(\"img업로드 성공\");\n      const imgUrl = res.data.url;\n      return imgUrl;\n    }).then(imgUrl => {\n      axios.put(`${apiUrl}/islogin/user/getinfo/${uid}`, {\n        nickname: nickname,\n        career: career,\n        userImage: imgUrl,\n        blogUrl: url\n      }, {\n        headers: {\n          Authorization: token\n        }\n      }).then(res => {\n        console.log(res);\n        dispatch(logEdit({\n          nickname: nickname,\n          career: career,\n          userImage: userImg,\n          blogUrl: url\n        }));\n        sessionStorage.setItem(\"nickname\", nickname);\n        sessionStorage.setItem(\"career\", career);\n        sessionStorage.setItem(\"userImage\", userImg);\n        sessionStorage.setItem(\"url\", url);\n        history.push(\"/\");\n        window.location.reload();\n      });\n    }).catch(err => {\n      console.log(err);\n      Swal.fire(\"\", \"회원 정보 수정 실패\", \"error\");\n    });\n  };\n};\n\nconst NewPassWordDB = (uid, password, newPassword, newPasswordCheck) => {\n  console.log(\"간다\");\n  return function (dispatch, getState, _ref7) {\n    let {\n      history\n    } = _ref7;\n    axios.put(`${apiUrl}/islogin/user/password/${uid}`, {\n      password: password,\n      newPassword: newPassword,\n      newPasswordCheck: newPasswordCheck\n    }, {\n      headers: {\n        Authorization: token\n      }\n    }).then(res => {\n      console.log(res.data);\n\n      if (res.data.result !== true) {\n        Swal.fire(\"\", \"비밀번호 수정 실패\", \"error\");\n        window.location.reload();\n      } else {\n        window.alert(\"비밀번호 수정 성공\");\n        history.push(\"/\");\n        window.location.replace(\"/\");\n      }\n    }).catch(err => {\n      console.log(err);\n      Swal.fire(\"\", \"비밀번호 수정 실패\", \"error\");\n    });\n  };\n};\n\n_c = NewPassWordDB;\nexport default handleActions({\n  [CHECK_USERNAME]: (state, action) => produce(state, draft => {\n    console.log(\"CHECK_USERNAME 리듀서로 적용 완료\", state, action.payload);\n    draft.isCheckUsername = action.payload.isCheckUsername;\n    window.alert(\"해당 이메일은 사용 가능합니다.\");\n  }),\n  [CHECK_NICKNAME]: (state, action) => produce(state, draft => {\n    console.log(\"CHECK_NICKNAME 리듀서 적용\", state, action.payload);\n    draft.isCheckNickname = action.payload.isCheckNickname;\n    window.alert(\"사용 가능한 닉네임입니다.\");\n  }),\n  [LOG_IN]: (state, action) => produce(state, draft => {\n    draft.userinfo = action.payload.user;\n    draft.isLogin = true;\n  }),\n  [USER_EDUT]: (state, action) => produce(state, draft => {\n    draft.userinfo = action.payload.user;\n  }),\n  [IMG_POST]: (state, action) => produce(state, draft => {\n    draft.preview = action.payload.preview;\n  })\n}, initialState);\nconst actionCreators = {\n  signupDB,\n  checkUsernameDB,\n  checkNicknameDB,\n  loginDB,\n  logOut,\n  logEditDB,\n  logEditDB2,\n  NewPassWordDB,\n  imgPost\n};\nexport { actionCreators };\n\nvar _c;\n\n$RefreshReg$(_c, \"NewPassWordDB\");","map":{"version":3,"sources":["/Users/cyj/sun/src/redux/modules/user.js"],"names":["createAction","handleActions","produce","history","axios","Swal","setToken","delToken","apiUrl","initialState","userinfo","uid","username","nickname","career","userImage","isLogin","isCheckUsername","isCheckNickname","preview","CHECK_USERNAME","CHECK_NICKNAME","LOG_IN","LOG_OUT","USER_EDUT","IMG_POST","setCheckUsername","setCheckNickname","logIn","user","logOut","logEdit","imgPost","token","sessionStorage","getItem","checkUsernameDB","dispatch","getState","console","log","post","then","res","data","fire","checkNicknameDB","userNickname","signupDB","password","passwordCheck","window","alert","location","reload","catch","err","loginDB","token_res","headers","authorization","method","url","Authorization","setItem","blogUrl","push","logEditDB","userImg","put","replace","logEditDB2","img_list","Data","FormData","append","imgUrl","NewPassWordDB","newPassword","newPasswordCheck","result","state","action","draft","payload","actionCreators"],"mappings":"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","sourcesContent":["import { createAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\nimport history from \"../configureStore\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\n\nimport { setToken, delToken } from \"../../shared/token\";\nimport { apiUrl } from \"../../elements/testApiUrl\";\n\n//initialState\nconst initialState = {\n  userinfo: {\n    uid: \"\",\n    username: \"\",\n    nickname: \"\",\n    career: \"\",\n    userImage: \"\",\n  },\n  isLogin: false,\n  isCheckUsername: false,\n  isCheckNickname: false,\n  preview: \"\",\n};\n\n//action\nconst CHECK_USERNAME = \"CHECK_USERNAME\";\nconst CHECK_NICKNAME = \"CHECK_NICKNAME\";\nconst LOG_IN = \"LOG_IN\";\nconst LOG_OUT = \"LOG_OUT\";\nconst USER_EDUT = \"USER_EDUT\";\nconst IMG_POST = \"IMG_POST\";\n\n//action creators\nconst setCheckUsername = createAction(CHECK_USERNAME, (isCheckUsername) => ({\n  isCheckUsername,\n}));\nconst setCheckNickname = createAction(CHECK_NICKNAME, (isCheckNickname) => ({\n  isCheckNickname,\n}));\nconst logIn = createAction(LOG_IN, (user) => ({ user }));\nconst logOut = createAction(LOG_OUT, () => ({}));\nconst logEdit = createAction(USER_EDUT, (user) => ({ user }));\nconst imgPost = createAction(IMG_POST, (preview) => ({ preview }));\n\n// //token\nconst token = sessionStorage.getItem(\"token\");\n\n//middleware actions\nconst checkUsernameDB = (username, isCheckUsername) => {\n  return async function (dispatch, getState, { history }) {\n    console.log(username, isCheckUsername);\n    await axios\n      .post(`${apiUrl}/user/signup/username`, { username: username })\n      .then((res) => {\n        if (res.data === true) {\n          Swal.fire(\"\", \"이미 존재하는 ID입니다.\", \"error\");\n          return;\n        }\n        dispatch(setCheckUsername(!isCheckUsername));\n        console.log(\"리듀서로\");\n      });\n  };\n};\n\nconst checkNicknameDB = (userNickname, isCheckNickname) => {\n  return async function (dispatch, getState, { history }) {\n    console.log(userNickname, isCheckNickname);\n    await axios\n      .post(`${apiUrl}/user/signup/nickname`, {\n        nickname: userNickname,\n      })\n      .then((res) => {\n        if (res.data === true) {\n          Swal.fire(\"\", \"이미 존재하는 닉네임입ㄴ디ㅏ.\", \"error\");\n          return;\n        }\n        console.log(res);\n        dispatch(setCheckNickname(!isCheckNickname));\n      });\n  };\n};\n\nconst signupDB = (username, nickname, password, passwordCheck, career) => {\n  return function (dispatch, getState, { history }) {\n    console.log(username, nickname, password, passwordCheck, career);\n    axios\n      .post(`${apiUrl}/user/signup`, {\n        username: username,\n        nickname: nickname,\n        password: password,\n        passwordCheck: passwordCheck,\n        career: career,\n      })\n      .then((res) => {\n        window.alert(\"회원가입을 축하드립니다.\");\n        window.location.reload();\n      })\n      .catch((err) => {\n        console.log(\"회원가입 실패\", err);\n        Swal.fire(\"\", \"회원가입에 실패했어요.\", \"error\");\n      });\n  };\n};\n\nconst loginDB = (username, password) => {\n  return function (dispatch, getState, { history }) {\n    console.log(username, password);\n    axios\n      .post(`${apiUrl}/user/login`, {\n        username: username,\n        password: password,\n      })\n      .then((res) => {\n        console.log(res);\n        const token_res = res.headers.authorization;\n        setToken(token_res);\n        return token_res;\n      })\n      .then((token_res) => {\n        console.log(token_res);\n        axios({\n          method: \"post\",\n          url: `${apiUrl}/islogin/user`,\n          headers: {\n            Authorization: `${token_res}`,\n          },\n        })\n          .then((res) => {\n            console.log(res);\n            sessionStorage.setItem(\"uid\", res.data.uid);\n            sessionStorage.setItem(\"username\", res.data.username);\n            sessionStorage.setItem(\"nickname\", res.data.nickname);\n            sessionStorage.setItem(\"career\", res.data.career);\n            sessionStorage.setItem(\"userImage\", res.data.userImage);\n            sessionStorage.setItem(\"url\", res.data.blogUrl);\n            sessionStorage.setItem(\"isLogin\", true);\n            console.log(\"1번\");\n            dispatch(\n              logIn({\n                uid: res.data.uid,\n                username: res.data.username,\n                nickname: res.data.nickname,\n                career: res.data.career,\n                userImage: res.data.userImage,\n                url: res.data.blogUrl,\n              })\n            );\n            history.push(\"/\");\n            window.location.reload();\n          })\n          .catch((err) => {\n            console.log(\"로그인 확인 실패\", err);\n          });\n      })\n      .catch((err) => {\n        console.log(err);\n        Swal.fire(\"\", \"이메일이나 패스워드를 다시 확인해주세요.\", \"error\");\n      });\n  };\n};\n\nconst logEditDB = (uid, nickname, career, url, userImg) => {\n  return function (dispatch, getState, { history }) {\n    console.log(uid, nickname, career, url);\n    axios\n      .put(\n        `${apiUrl}/islogin/user/getinfo/${uid}`,\n        {\n          nickname: nickname,\n          career: career,\n          userImage: \"\",\n          blogUrl: url,\n        },\n        {\n          headers: {\n            Authorization: token,\n          },\n        }\n      )\n      .then((res) => {\n        console.log(res.data);\n        dispatch(\n          logEdit({\n            nickname: nickname,\n            career: career,\n            userImage: userImg,\n            blogUrl: url,\n          })\n        );\n        sessionStorage.setItem(\"nickname\", nickname);\n        sessionStorage.setItem(\"career\", career);\n        sessionStorage.setItem(\"url\", url);\n        window.location.replace(\"/\");\n      })\n      .catch((err) => {\n        console.log(err);\n        Swal.fire(\"\", \"회원 정보 수정 실패\", \"error\");\n      });\n  };\n};\n\nconst logEditDB2 = (uid, nickname, career, url, userImg) => {\n  return function (dispatch, getState, { history }) {\n    const img_list = getState().user.preview;\n    const Data = new FormData();\n    Data.append(\"images\", img_list);\n    console.log(img_list);\n    axios\n      .post(`${apiUrl}/images/upload`, Data, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: token,\n        },\n      })\n      .then((res) => {\n        console.log(\"img업로드 성공\");\n        const imgUrl = res.data.url;\n        return imgUrl;\n      })\n\n      .then((imgUrl) => {\n        axios\n          .put(\n            `${apiUrl}/islogin/user/getinfo/${uid}`,\n            {\n              nickname: nickname,\n              career: career,\n              userImage: imgUrl,\n              blogUrl: url,\n            },\n            {\n              headers: {\n                Authorization: token,\n              },\n            }\n          )\n          .then((res) => {\n            console.log(res);\n            dispatch(\n              logEdit({\n                nickname: nickname,\n                career: career,\n                userImage: userImg,\n                blogUrl: url,\n              })\n            );\n            sessionStorage.setItem(\"nickname\", nickname);\n            sessionStorage.setItem(\"career\", career);\n            sessionStorage.setItem(\"userImage\", userImg);\n            sessionStorage.setItem(\"url\", url);\n            history.push(\"/\");\n            window.location.reload();\n          });\n      })\n      .catch((err) => {\n        console.log(err);\n        Swal.fire(\"\", \"회원 정보 수정 실패\", \"error\");\n      });\n  };\n};\n\nconst NewPassWordDB = (uid, password, newPassword, newPasswordCheck) => {\n  console.log(\"간다\");\n  return function (dispatch, getState, { history }) {\n    axios\n      .put(\n        `${apiUrl}/islogin/user/password/${uid}`,\n        {\n          password: password,\n          newPassword: newPassword,\n          newPasswordCheck: newPasswordCheck,\n        },\n        {\n          headers: {\n            Authorization: token,\n          },\n        }\n      )\n      .then((res) => {\n        console.log(res.data);\n        if (res.data.result !== true) {\n          Swal.fire(\"\", \"비밀번호 수정 실패\", \"error\");\n          window.location.reload();\n        } else {\n          window.alert(\"비밀번호 수정 성공\");\n          history.push(\"/\");\n          window.location.replace(\"/\");\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n        Swal.fire(\"\", \"비밀번호 수정 실패\", \"error\");\n      });\n  };\n};\n\nexport default handleActions(\n  {\n    [CHECK_USERNAME]: (state, action) =>\n      produce(state, (draft) => {\n        console.log(\"CHECK_USERNAME 리듀서로 적용 완료\", state, action.payload);\n        draft.isCheckUsername = action.payload.isCheckUsername;\n        window.alert(\"해당 이메일은 사용 가능합니다.\");\n      }),\n    [CHECK_NICKNAME]: (state, action) =>\n      produce(state, (draft) => {\n        console.log(\"CHECK_NICKNAME 리듀서 적용\", state, action.payload);\n        draft.isCheckNickname = action.payload.isCheckNickname;\n        window.alert(\"사용 가능한 닉네임입니다.\");\n      }),\n    [LOG_IN]: (state, action) =>\n      produce(state, (draft) => {\n        draft.userinfo = action.payload.user;\n        draft.isLogin = true;\n      }),\n    [USER_EDUT]: (state, action) =>\n      produce(state, (draft) => {\n        draft.userinfo = action.payload.user;\n      }),\n    [IMG_POST]: (state, action) =>\n      produce(state, (draft) => {\n        draft.preview = action.payload.preview;\n      }),\n  },\n  initialState\n);\n\nconst actionCreators = {\n  signupDB,\n  checkUsernameDB,\n  checkNicknameDB,\n  loginDB,\n  logOut,\n  logEditDB,\n  logEditDB2,\n  NewPassWordDB,\n  imgPost,\n};\n\nexport { actionCreators };\n"]},"metadata":{},"sourceType":"module"}